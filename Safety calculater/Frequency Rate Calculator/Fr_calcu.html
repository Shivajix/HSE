<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Frequency Rate (FR) Calculator | HSE Tools</title>
    <meta name="description" content="Calculate Frequency Rate (FR) for safety metrics. Supports OSHA and International standards with project tracking and PDF export.">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --primary: #2c5aa0;
            --primary-dark: #1e3d72;
            --secondary: #4caf50;
            --secondary-dark: #388e3c;
            --danger: #f44336;
            --warning: #ff9800;
            --info: #2196f3;
            --light: #f5f7fa;
            --dark: #333;
            --gray: #6c757d;
            --border: #dee2e6;
            --bg-color: #f5f7fa;
            --card-bg: white;
            --text-color: #333;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .dark-mode {
            --bg-color: #1a1a1a;
            --card-bg: #2d2d2d;
            --text-color: #f0f0f0;
            --border: #444;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }

        body {
            background: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            min-height: 100vh;
            padding: 15px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Header */
        header {
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: var(--shadow);
            padding: 20px;
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
            flex: 1;
            min-width: 250px;
        }

        .logo-icon {
            background: var(--primary);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            flex-shrink: 0;
        }

        .logo-text h1 {
            font-size: clamp(20px, 4vw, 28px);
            color: var(--primary);
            margin-bottom: 5px;
        }

        .logo-text p {
            color: var(--gray);
            font-size: clamp(12px, 2vw, 14px);
        }

        .header-controls {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        /* Buttons */
        .btn {
            padding: 10px 18px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-success {
            background: var(--secondary);
            color: white;
        }

        .btn-success:hover {
            background: var(--secondary-dark);
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background: var(--primary);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-toggle {
            background: var(--gray);
            color: white;
        }

        .btn-image {
            background: #9c27b0;
            color: white;
        }

        .btn-image:hover {
            background: #7b1fa2;
        }

        /* Card Layout */
        .card-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(min(100%, 350px), 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .card {
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: var(--shadow);
            padding: 20px;
            transition: transform 0.3s, box-shadow 0.3s;
            display: flex;
            flex-direction: column;
            height: fit-content;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.12);
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
            flex-wrap: wrap;
            gap: 10px;
        }

        .card-icon {
            width: 45px;
            height: 45px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            flex-shrink: 0;
        }

        .card-title {
            font-size: clamp(16px, 3vw, 20px);
            color: var(--primary);
            font-weight: 600;
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 18px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-color);
            font-size: 14px;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 14px;
            transition: border 0.3s;
            background: var(--card-bg);
            color: var(--text-color);
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(44, 90, 160, 0.1);
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(min(100%, 200px), 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        /* Radio Options */
        .radio-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 12px;
            margin-top: 10px;
        }

        .radio-option {
            text-align: center;
        }

        .radio-option input {
            display: none;
        }

        .radio-option label {
            display: block;
            padding: 12px 8px;
            border: 2px solid var(--border);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            font-size: 13px;
        }

        .radio-option input:checked + label {
            border-color: var(--primary);
            background: rgba(44, 90, 160, 0.1);
            color: var(--primary);
        }

        .radio-option label:hover {
            border-color: var(--primary);
        }

        /* Template Section */
        .template-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin-bottom: 15px;
        }

        .template-btn {
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 6px;
            background: var(--card-bg);
            color: var(--text-color);
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            text-align: center;
        }

        .template-btn:hover {
            border-color: var(--primary);
            background: rgba(44, 90, 160, 0.1);
        }

        /* Helper Options */
        .helper-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .helper-option {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .helper-option input {
            width: auto;
        }

        /* Tip Box */
        .tip {
            background-color: rgba(33, 150, 243, 0.1);
            padding: 12px 15px;
            border-radius: 6px;
            font-size: 13px;
            color: var(--text-color);
            margin-top: 15px;
            border-left: 4px solid var(--info);
        }

        /* Actions Card */
        .actions-card {
            grid-column: 1 / -1;
        }

        .actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        /* Footer */
        .footer-note {
            margin-top: 25px;
            padding: 15px;
            border-radius: 8px;
            font-size: 13px;
            color: var(--gray);
            text-align: center;
            background: var(--card-bg);
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        /* Popup Preview */
        .popup-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 15px;
        }

        .popup-content {
            background: var(--card-bg);
            width: 100%;
            max-width: min(95%, 900px);
            max-height: 90vh;
            border-radius: 8px;
            overflow-y: auto;
            padding: 25px;
            position: relative;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .popup-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--primary);
            flex-wrap: wrap;
            gap: 10px;
        }

        .popup-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--gray);
            transition: color 0.3s;
        }

        .popup-close:hover {
            color: var(--dark);
        }

        .popup-actions {
            display: flex;
            gap: 12px;
            margin-top: 25px;
            justify-content: center;
            flex-wrap: wrap;
        }

        /* A4 Preview */
        .a4-preview {
            width: 100%;
            max-width: 210mm;
            min-height: 297mm;
            padding: 15mm;
            margin: 0 auto;
            background: white;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            border: 1px solid #ccc;
        }

        .a4-header {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--primary);
        }

        .a4-header h1 {
            color: var(--primary);
            margin-bottom: 10px;
            font-size: clamp(20px, 4vw, 24px);
        }

        .a4-date {
            color: var(--gray);
            font-size: 14px;
            font-weight: 500;
        }

        .a4-section {
            margin-bottom: 25px;
            padding: 15px;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: #fafbfc;
        }

        .a4-section h2 {
            color: var(--primary);
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border);
            font-size: clamp(16px, 3vw, 18px);
        }

        .a4-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .a4-box {
            background: white;
            padding: 15px;
            border-radius: 6px;
            text-align: center;
            border: 1px solid var(--border);
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .a4-box h3 {
            font-size: 14px;
            margin-bottom: 10px;
            color: var(--primary);
            font-weight: 600;
        }

        .a4-box .value {
            font-size: clamp(20px, 4vw, 24px);
            font-weight: bold;
            color: var(--secondary);
        }

        /* Preview Tables */
        .project-info-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            border: 1px solid var(--dark);
            font-size: clamp(11px, 2vw, 13px);
        }

        .project-info-table th, .project-info-table td {
            padding: 10px;
            border: 1px solid var(--dark);
            text-align: left;
        }

        .project-info-table th {
            background: var(--primary);
            color: white;
            font-weight: 600;
            width: 30%;
        }

        .project-info-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        /* Comparison Section */
        .comparison-section {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid var(--info);
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 15px;
        }

        .comparison-item {
            background: white;
            padding: 15px;
            border-radius: 6px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .comparison-item h3 {
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 16px;
        }

        .comparison-list {
            list-style: none;
            padding: 0;
        }

        .comparison-list li {
            padding: 8px 0;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .comparison-list li:before {
            content: "•";
            color: var(--secondary);
            font-size: 18px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            header {
                padding: 15px;
                text-align: center;
                flex-direction: column;
            }
            
            .logo {
                justify-content: center;
                text-align: center;
            }
            
            .header-controls {
                justify-content: center;
            }
            
            .btn {
                padding: 10px 15px;
                font-size: 13px;
            }
            
            .card {
                padding: 15px;
            }
            
            .card-header {
                flex-direction: column;
                text-align: center;
            }
            
            .card-icon {
                margin: 0 auto;
            }
            
            .helper-options {
                grid-template-columns: 1fr;
            }
            
            .template-section {
                grid-template-columns: 1fr;
            }
            
            .a4-preview {
                padding: 10mm;
            }
            
            .popup-content {
                padding: 20px;
            }
            
            .comparison-grid {
                grid-template-columns: 1fr;
            }
            
            .popup-actions {
                flex-direction: column;
            }
        }
        
        @media (max-width: 480px) {
            body {
                padding: 8px;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            .a4-preview {
                padding: 8mm;
            }
            
            .project-info-table {
                font-size: 10px;
            }
            
            .project-info-table th, .project-info-table td {
                padding: 6px 4px;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-calculator"></i>
                </div>
                <div class="logo-text">
                    <h1 data-en="Frequency Rate (FR) Calculator" data-hi="फ्रीक्वेंसी रेट (FR) कैलकुलेटर">Frequency Rate (FR) Calculator</h1>
                    <p data-en="Enter details, preview, and export to PDF/Image" data-hi="विवरण दर्ज करें, पूर्वावलोकन करें और पीडीएफ/इमेज निर्यात करें">Enter details, preview, and export to PDF/Image</p>
                </div>
            </div>
            <div class="header-controls">
                <button class="btn btn-toggle" id="languageToggle">
                    <i class="fas fa-language"></i> <span data-en="हिंदी" data-hi="English">हिंदी</span>
                </button>
                <button class="btn btn-toggle" id="themeToggle">
                    <i class="fas fa-moon"></i> <span data-en="Dark Mode" data-hi="डार्क मोड">Dark Mode</span>
                </button>
            </div>
        </header>
        
        <div class="card-container">
            <!-- Project Details Card -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon" style="background: #e3f2fd; color: #1976d2;">
                        <i class="fas fa-project-diagram"></i>
                    </div>
                    <h2 class="card-title" data-en="Project / Site" data-hi="प्रोजेक्ट / साइट">Project / Site</h2>
                </div>
                <div class="form-group">
                    <label for="projectName" data-en="Project / Site Name" data-hi="प्रोजेक्ट / साइट का नाम">Project / Site Name</label>
                    <input type="text" id="projectName" placeholder="e.g., Riverfront Expressway Pkg-III" data-en-placeholder="e.g., Riverfront Expressway Pkg-III" data-hi-placeholder="उदाहरण, रिवरफ्रंट एक्सप्रेसवे पैकेज-III">
                </div>
                <div class="form-group">
                    <label for="client" data-en="Client / Company" data-hi="क्लाइंट / कंपनी">Client / Company</label>
                    <input type="text" id="client" placeholder="e.g., InfraBuild Constructions Ltd." data-en-placeholder="e.g., InfraBuild Constructions Ltd." data-hi-placeholder="उदाहरण, इन्फ्राबिल्ड कंस्ट्रक्शन्स लिमिटेड">
                </div>
                <div class="form-group">
                    <label for="location" data-en="Location" data-hi="स्थान">Location</label>
                    <input type="text" id="location" placeholder="City, Country" data-en-placeholder="City, Country" data-hi-placeholder="शहर, देश">
                </div>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="periodFrom" data-en="Period (From)" data-hi="अवधि (से)">Period (From)</label>
                        <input type="date" id="periodFrom">
                    </div>
                    <div class="form-group">
                        <label for="periodTo" data-en="Period (To)" data-hi="अवधि (तक)">Period (To)</label>
                        <input type="date" id="periodTo">
                    </div>
                </div>
                <div class="form-group">
                    <label data-en="Load Example" data-hi="उदाहरण लोड करें">Load Example</label>
                    <div class="template-section">
                        <button class="template-btn" data-template="construction" data-en="Construction" data-hi="निर्माण">Construction</button>
                        <button class="template-btn" data-template="manufacturing" data-en="Manufacturing" data-hi="विनिर्माण">Manufacturing</button>
                        <button class="template-btn" data-template="oil-gas" data-en="O&G Turnaround" data-hi="तेल एवं गैस">O&G Turnaround</button>
                    </div>
                </div>
                <div class="tip" data-en="These fill in realistic values so students can see how each section is completed." data-hi="ये वास्तविक मान भरते हैं ताकि छात्र देख सकें कि प्रत्येक अनुभाग कैसे पूरा होता है।">
                    These fill in realistic values so students can see how each section is completed.
                </div>
            </div>
            
            <!-- FR Inputs Card -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon" style="background: #e8f5e9; color: #388e3c;">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <h2 class="card-title" data-en="FR Inputs" data-hi="FR इनपुट">FR Inputs</h2>
                </div>
                <div class="form-group">
                    <p><strong data-en="Frequency Rate (FR) = (Incidents × Rate Base) ÷ Total Man-Hours" data-hi="फ्रीक्वेंसी रेट (FR) = (घटनाएं × रेट बेस) ÷ कुल मैन-आवर्स">Frequency Rate (FR) = (Incidents × Rate Base) ÷ Total Man-Hours</strong></p>
                    <p data-en="Use 1,000,000 (International) or 200,000 (OSHA) as the rate base." data-hi="रेट बेस के रूप में 1,000,000 (अंतर्राष्ट्रीय) या 200,000 (OSHA) का उपयोग करें।">Use 1,000,000 (International) or 200,000 (OSHA) as the rate base.</p>
                </div>
                <div class="tip">
                    <strong data-en="Note for students:" data-hi="छात्रों के लिए नोट:">Note for students:</strong> 
                    <span data-en="What data you need & how to calculate FR" data-hi="आपको कौन सा डेटा चाहिए और FR की गणना कैसे करें">What data you need & how to calculate FR</span>
                </div>
                
                <div class="form-group">
                    <label data-en="Rate Base" data-hi="रेट बेस">Rate Base</label>
                    <div class="radio-options">
                        <div class="radio-option">
                            <input type="radio" id="base-international" name="rateBase" value="1000000" checked>
                            <label for="base-international" data-en="Per 1,000,000 hours (International)" data-hi="प्रति 1,000,000 घंटे (अंतर्राष्ट्रीय)">Per 1,000,000 hours (International)</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="base-osha" name="rateBase" value="200000">
                            <label for="base-osha" data-en="Per 200,000 hours (OSHA)" data-hi="प्रति 200,000 घंटे (OSHA)">Per 200,000 hours (OSHA)</label>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label data-en="Total Man-Hours Entry" data-hi="कुल मैन-आवर्स एंट्री">Total Man-Hours Entry</label>
                    <div class="helper-options">
                        <div class="helper-option">
                            <input type="radio" id="direct-entry" name="hoursEntry" value="direct" checked>
                            <label for="direct-entry" data-en="Enter Total Man-Hours directly" data-hi="कुल मैन-आवर्स सीधे दर्ज करें">Enter Total Man-Hours directly</label>
                        </div>
                        <div class="helper-option">
                            <input type="radio" id="calculate-entry" name="hoursEntry" value="calculate">
                            <label for="calculate-entry" data-en="Calculate using helper (Workers × Hours/Day × Days × Shifts)" data-hi="हेल्पर का उपयोग करके गणना करें (कर्मचारी × घंटे/दिन × दिन × शिफ्ट)">Calculate using helper (Workers × Hours/Day × Days × Shifts)</label>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="totalManHours" data-en="Total Man-Hours" data-hi="कुल मैन-आवर्स">Total Man-Hours</label>
                    <input type="number" id="totalManHours" placeholder="e.g., 450000" data-en-placeholder="e.g., 450000" data-hi-placeholder="उदाहरण, 450000">
                </div>
                
                <div id="calculationHelper" style="display: none;">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="workers" data-en="Workers" data-hi="कर्मचारी">Workers</label>
                            <input type="number" id="workers" placeholder="Number of workers" data-en-placeholder="Number of workers" data-hi-placeholder="कर्मचारियों की संख्या">
                        </div>
                        <div class="form-group">
                            <label for="hoursPerDay" data-en="Hours/Day" data-hi="घंटे/दिन">Hours/Day</label>
                            <input type="number" id="hoursPerDay" placeholder="Hours per day" data-en-placeholder="Hours per day" data-hi-placeholder="प्रतिदिन घंटे">
                        </div>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="days" data-en="Days" data-hi="दिन">Days</label>
                            <input type="number" id="days" placeholder="Number of days" data-en-placeholder="Number of days" data-hi-placeholder="दिनों की संख्या">
                        </div>
                        <div class="form-group">
                            <label for="shifts" data-en="Shifts" data-hi="शिफ्ट">Shifts</label>
                            <input type="number" id="shifts" placeholder="Shifts per day" value="1" data-en-placeholder="Shifts per day" data-hi-placeholder="प्रतिदिन शिफ्ट">
                        </div>
                    </div>
                    <button class="btn btn-outline" id="calculateHours">
                        <i class="fas fa-calculator"></i> <span data-en="Calculate Man-Hours" data-hi="मैन-आवर्स की गणना करें">Calculate Man-Hours</span>
                    </button>
                </div>
                
                <div class="form-group">
                    <label for="incidents" data-en="Number of incidents (counted for FR)" data-hi="घटनाओं की संख्या (FR के लिए गिनी गई)">Number of incidents (counted for FR)</label>
                    <input type="number" id="incidents" placeholder="0" value="0" min="0" data-en-placeholder="0" data-hi-placeholder="0">
                </div>
            </div>
            
            <!-- Actions Card -->
            <div class="card actions-card">
                <div class="card-header">
                    <div class="card-icon" style="background: #e1f5fe; color: #0288d1;">
                        <i class="fas fa-cogs"></i>
                    </div>
                    <h2 class="card-title" data-en="Actions" data-hi="कार्रवाई">Actions</h2>
                </div>
                <div class="actions-grid">
                    <button class="btn btn-primary" id="previewBtn">
                        <i class="fas fa-eye"></i> <span data-en="Preview" data-hi="पूर्वावलोकन">Preview</span>
                    </button>
                    <button class="btn btn-success" id="downloadBtn">
                        <i class="fas fa-download"></i> <span data-en="Download PDF" data-hi="पीडीएफ डाउनलोड करें">Download PDF</span>
                    </button>
                    <button class="btn btn-image" id="downloadImageBtn">
                        <i class="fas fa-image"></i> <span data-en="Download Image" data-hi="इमेज डाउनलोड करें">Download Image</span>
                    </button>
                    <button class="btn btn-danger" id="resetBtn">
                        <i class="fas fa-redo"></i> <span data-en="Reset" data-hi="रीसेट">Reset</span>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Comparison Section -->
        <div class="comparison-section">
            <h2 data-en="PDF vs Image Comparison" data-hi="पीडीएफ बनाम इमेज तुलना">PDF vs Image Comparison</h2>
            <div class="comparison-grid">
                <div class="comparison-item">
                    <h3 data-en="PDF Download" data-hi="पीडीएफ डाउनलोड">PDF Download</h3>
                    <ul class="comparison-list">
                        <li data-en="Vector format - High quality" data-hi="वेक्टर फॉर्मेट - उच्च गुणवत्ता">Vector format - High quality</li>
                        <li data-en="Text remains selectable" data-hi="टेक्स्ट चयन योग्य रहता है">Text remains selectable</li>
                        <li data-en="Smaller file size" data-hi="छोटा फाइल आकार">Smaller file size</li>
                        <li data-en="Professional appearance" data-hi="पेशेवर दिखावट">Professional appearance</li>
                        <li data-en="Editable in PDF readers" data-hi="पीडीएफ रीडर में संपादन योग्य">Editable in PDF readers</li>
                    </ul>
                </div>
                <div class="comparison-item">
                    <h3 data-en="Image Download" data-hi="इमेज डाउनलोड">Image Download</h3>
                    <ul class="comparison-list">
                        <li data-en="Raster format - Pixel based" data-hi="रेस्टर फॉर्मेट - पिक्सेल आधारित">Raster format - Pixel based</li>
                        <li data-en="Text not selectable" data-hi="टेक्स्ट चयन योग्य नहीं">Text not selectable</li>
                        <li data-en="Larger file size" data-hi="बड़ा फाइल आकार">Larger file size</li>
                        <li data-en="Easy to share on social media" data-hi="सोशल मीडिया पर शेयर करना आसान">Easy to share on social media</li>
                        <li data-en="Universal compatibility" data-hi="सार्वभौमिक संगतता">Universal compatibility</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="footer-note" data-en="Frequency Rate (FR) is a key safety metric showing the number of recordable incidents per hours worked." data-hi="फ्रीक्वेंसी रेट (FR) एक प्रमुख सुरक्षा मीट्रिक है जो काम के घंटों में दर्ज की गई घटनाओं की संख्या दर्शाता है।">
            Frequency Rate (FR) is a key safety metric showing the number of recordable incidents per hours worked.
        </div>
    </div>

    <!-- Popup Preview -->
    <div class="popup-overlay" id="previewPopup">
        <div class="popup-content">
            <div class="popup-header">
                <h1 data-en="Frequency Rate (FR) Report" data-hi="फ्रीक्वेंसी रेट (FR) रिपोर्ट">Frequency Rate (FR) Report</h1>
                <button class="popup-close" id="closePopup">&times;</button>
            </div>
            
            <!-- A4 Preview Content -->
            <div class="a4-preview" id="a4Preview">
                <div class="a4-header">
                    <h1 data-en="Frequency Rate (FR) Report" data-hi="फ्रीक्वेंसी रेट (FR) रिपोर्ट">Frequency Rate (FR) Report</h1>
                    <p data-en="Generated preview – review and export to PDF/Image" data-hi="जनरेटेड पूर्वावलोकन – समीक्षा करें और पीडीएफ/इमेज निर्यात करें">Generated preview – review and export to PDF/Image</p>
                    <div class="a4-date" id="previewDate"></div>
                </div>
                
                <div class="a4-section">
                    <h2 data-en="Project Information" data-hi="प्रोजेक्ट जानकारी">Project Information</h2>
                    <table class="project-info-table">
                        <tr>
                            <th data-en="Project / Site" data-hi="प्रोजेक्ट / साइट">Project / Site</th>
                            <td id="previewProject">--</td>
                        </tr>
                        <tr>
                            <th data-en="Client" data-hi="क्लाइंट">Client</th>
                            <td id="previewClient">--</td>
                        </tr>
                        <tr>
                            <th data-en="Location" data-hi="स्थान">Location</th>
                            <td id="previewLocation">--</td>
                        </tr>
                        <tr>
                            <th data-en="Reporting Period" data-hi="रिपोर्टिंग अवधि">Reporting Period</th>
                            <td id="previewPeriod">--</td>
                        </tr>
                    </table>
                </div>
                
                <div class="a4-grid">
                    <div class="a4-box">
                        <h3 data-en="INCIDENTS" data-hi="घटनाएं">INCIDENTS</h3>
                        <div class="value" id="previewIncidents">0</div>
                    </div>
                    <div class="a4-box">
                        <h3 data-en="BASE" data-hi="बेस">BASE</h3>
                        <div class="value" id="previewBase">1,000,000</div>
                    </div>
                    <div class="a4-box">
                        <h3 data-en="MAN-HOURS" data-hi="मैन-आवर्स">MAN-HOURS</h3>
                        <div class="value" id="previewManHours">0</div>
                    </div>
                    <div class="a4-box">
                        <h3 data-en="FR" data-hi="FR">FR</h3>
                        <div class="value" id="previewFR">0.00</div>
                    </div>
                </div>
                
                <div class="a4-section">
                    <h2 data-en="Calculation" data-hi="गणना">Calculation</h2>
                    <p><strong data-en="Frequency Rate (FR) = (Incidents × Base) ÷ Man-Hours" data-hi="फ्रीक्वेंसी रेट (FR) = (घटनाएं × बेस) ÷ मैन-आवर्स">Frequency Rate (FR) = (Incidents × Base) ÷ Man-Hours</strong></p>
                    <p id="previewCalculation" data-en="= (0 × 1,000,000) ÷ 0" data-hi="= (0 × 1,000,000) ÷ 0">= (0 × 1,000,000) ÷ 0</p>
                    <p id="previewRateBase" data-en="Rate Base: Per 1,000,000 hrs" data-hi="रेट बेस: प्रति 1,000,000 घंटे">Rate Base: Per 1,000,000 hrs</p>
                </div>
                
                <div class="a4-section">
                    <h2 data-en="Notes" data-hi="नोट्स">Notes</h2>
                    <p id="previewNotes" data-en="Generated by The HSE Tools – Frequency Rate (FR) Calculator" data-hi="द हेल्थ सेफ्टी एनवायरनमेंट टूल्स - फ्रीक्वेंसी रेट (FR) कैलकुलेटर द्वारा जनरेट किया गया">Generated by The HSE Tools – Frequency Rate (FR) Calculator</p>
                </div>
            </div>
            
            <div class="popup-actions">
                <button class="btn btn-success" id="downloadFromPopup">
                    <i class="fas fa-file-pdf"></i> <span data-en="Download PDF" data-hi="पीडीएफ डाउनलोड करें">Download PDF</span>
                </button>
                <button class="btn btn-image" id="downloadImageFromPopup">
                    <i class="fas fa-image"></i> <span data-en="Download Image" data-hi="इमेज डाउनलोड करें">Download Image</span>
                </button>
                <button class="btn btn-outline" id="closePopupBtn">
                    <i class="fas fa-times"></i> <span data-en="Close" data-hi="बंद करें">Close</span>
                </button>
            </div>
        </div>
    </div>

    <script>
        // Language management
        let currentLanguage = 'en';
        
        // Set current date for preview
        document.getElementById('previewDate').textContent = new Date().toLocaleString();
        
        // Theme Toggle
        const themeToggle = document.getElementById('themeToggle');
        themeToggle.addEventListener('click', function() {
            document.body.classList.toggle('dark-mode');
            updateLanguage(currentLanguage);
        });
        
        // Language Toggle
        const languageToggle = document.getElementById('languageToggle');
        languageToggle.addEventListener('click', function() {
            currentLanguage = currentLanguage === 'en' ? 'hi' : 'en';
            updateLanguage(currentLanguage);
        });
        
        // Function to update all text content based on language
        function updateLanguage(lang) {
            document.querySelectorAll('[data-en]').forEach(element => {
                if (element.tagName === 'INPUT' && element.hasAttribute('placeholder')) {
                    element.placeholder = element.getAttribute(`data-${lang}-placeholder`) || element.getAttribute(`data-${lang}`);
                } else {
                    element.textContent = element.getAttribute(`data-${lang}`);
                }
            });
            
            const toggleText = document.querySelector('#languageToggle span');
            toggleText.textContent = toggleText.getAttribute(`data-${lang}`);
            
            updatePreview();
        }
        
        // Template buttons
        document.querySelectorAll('.template-btn').forEach(button => {
            button.addEventListener('click', function() {
                const template = this.getAttribute('data-template');
                loadTemplate(template);
            });
        });
        
        function loadTemplate(template) {
            if (template === 'construction') {
                document.getElementById('projectName').value = 'Riverfront Expressway Pkg-III';
                document.getElementById('client').value = 'InfraBuild Constructions Ltd.';
                document.getElementById('location').value = 'Mumbai, India';
                document.getElementById('totalManHours').value = '450000';
                document.getElementById('incidents').value = '2';
            } else if (template === 'manufacturing') {
                document.getElementById('projectName').value = 'Auto Parts Manufacturing Plant';
                document.getElementById('client').value = 'Precision Auto Components Ltd.';
                document.getElementById('location').value = 'Pune, India';
                document.getElementById('totalManHours').value = '280000';
                document.getElementById('incidents').value = '1';
            } else if (template === 'oil-gas') {
                document.getElementById('projectName').value = 'Refinery Turnaround Project';
                document.getElementById('client').value = 'PetroEnergy Corp';
                document.getElementById('location').value = 'Gujarat, India';
                document.getElementById('totalManHours').value = '650000';
                document.getElementById('incidents').value = '0';
            }
            calculateFR();
        }
        
        // Man-hours calculation helper
        const directEntry = document.getElementById('direct-entry');
        const calculateEntry = document.getElementById('calculate-entry');
        const calculationHelper = document.getElementById('calculationHelper');
        
        directEntry.addEventListener('change', function() {
            if (this.checked) {
                calculationHelper.style.display = 'none';
            }
        });
        
        calculateEntry.addEventListener('change', function() {
            if (this.checked) {
                calculationHelper.style.display = 'block';
            }
        });
        
        document.getElementById('calculateHours').addEventListener('click', function() {
            const workers = parseInt(document.getElementById('workers').value) || 0;
            const hoursPerDay = parseInt(document.getElementById('hoursPerDay').value) || 0;
            const days = parseInt(document.getElementById('days').value) || 0;
            const shifts = parseInt(document.getElementById('shifts').value) || 1;
            
            const totalHours = workers * hoursPerDay * days * shifts;
            document.getElementById('totalManHours').value = totalHours;
            calculateFR();
        });
        
        // Calculate FR
        function calculateFR() {
            const totalManHours = parseInt(document.getElementById('totalManHours').value) || 0;
            const incidents = parseInt(document.getElementById('incidents').value) || 0;
            const rateBase = document.querySelector('input[name="rateBase"]:checked').value;
            
            let fr = 0;
            if (totalManHours > 0) {
                fr = (incidents * rateBase) / totalManHours;
            }
            
            return {
                totalManHours,
                incidents,
                rateBase,
                fr: fr.toFixed(2)
            };
        }
        
        // Update preview
        function updatePreview() {
            const data = calculateFR();
            
            document.getElementById('previewProject').textContent = 
                document.getElementById('projectName').value || '--';
            document.getElementById('previewClient').textContent = 
                document.getElementById('client').value || '--';
            document.getElementById('previewLocation').textContent = 
                document.getElementById('location').value || '--';
            
            const from = document.getElementById('periodFrom').value;
            const to = document.getElementById('periodTo').value;
            document.getElementById('previewPeriod').textContent = 
                (from && to) ? `${from} to ${to}` : '--';
            
            document.getElementById('previewIncidents').textContent = data.incidents;
            document.getElementById('previewBase').textContent = 
                data.rateBase === '1000000' ? '1,000,000' : '200,000';
            document.getElementById('previewManHours').textContent = data.totalManHours.toLocaleString();
            document.getElementById('previewFR').textContent = data.fr;
            
            const calculationText = `= (${data.incidents} × ${data.rateBase === '1000000' ? '1,000,000' : '200,000'}) ÷ ${data.totalManHours.toLocaleString()}`;
            document.getElementById('previewCalculation').textContent = calculationText;
            
            const rateBaseText = `Rate Base: ${data.rateBase === '1000000' ? 'Per 1,000,000 hrs' : 'Per 200,000 hrs (OSHA)'}`;
            document.getElementById('previewRateBase').textContent = rateBaseText;
        }
        
        // Popup functionality
        function openPopup() {
            updatePreview();
            document.getElementById('previewPopup').style.display = 'flex';
        }
        
        function closePopup() {
            document.getElementById('previewPopup').style.display = 'none';
        }
        
        document.getElementById('previewBtn').addEventListener('click', openPopup);
        document.getElementById('closePopup').addEventListener('click', closePopup);
        document.getElementById('closePopupBtn').addEventListener('click', closePopup);
        
        document.getElementById('previewPopup').addEventListener('click', function(e) {
            if (e.target === this) {
                closePopup();
            }
        });
        
        // PDF Download functionality
        async function downloadPDF() {
            updatePreview();
            
            const downloadBtn = event.target;
            const originalText = downloadBtn.innerHTML;
            downloadBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating PDF...';
            downloadBtn.disabled = true;
            
            try {
                await new Promise(resolve => setTimeout(resolve, 500));
                
                const element = document.getElementById('a4Preview');
                
                if (!element) {
                    throw new Error('Preview element not found');
                }
                
                const options = {
                    margin: 10,
                    filename: 'frequency-rate-report.pdf',
                    image: { type: 'jpeg', quality: 0.98 },
                    html2canvas: { 
                        scale: 2,
                        useCORS: true,
                        logging: true,
                        windowWidth: element.scrollWidth,
                        windowHeight: element.scrollHeight
                    },
                    jsPDF: { 
                        unit: 'mm', 
                        format: 'a4', 
                        orientation: 'portrait' 
                    }
                };
                
                await html2pdf().set(options).from(element).save();
                
            } catch (error) {
                console.error('PDF generation error:', error);
                alert(currentLanguage === 'en' 
                    ? 'PDF download failed. Please try again.' 
                    : 'पीडीएफ डाउनलोड विफल। कृपया पुनः प्रयास करें।');
            } finally {
                downloadBtn.innerHTML = originalText;
                downloadBtn.disabled = false;
            }
        }
        
        // Image Download functionality
        async function downloadImage() {
            updatePreview();
            
            const downloadBtn = event.target;
            const originalText = downloadBtn.innerHTML;
            downloadBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Image...';
            downloadBtn.disabled = true;
            
            try {
                await new Promise(resolve => setTimeout(resolve, 500));
                
                const element = document.getElementById('a4Preview');
                
                if (!element) {
                    throw new Error('Preview element not found');
                }
                
                // Use html2canvas to convert the preview to an image
                const canvas = await html2canvas(element, {
                    scale: 2,
                    useCORS: true,
                    logging: false,
                    backgroundColor: '#ffffff'
                });
                
                // Convert canvas to image and download
                const image = canvas.toDataURL('image/png', 1.0);
                const link = document.createElement('a');
                link.download = 'frequency-rate-report.png';
                link.href = image;
                link.click();
                
            } catch (error) {
                console.error('Image generation error:', error);
                alert(currentLanguage === 'en' 
                    ? 'Image download failed. Please try again.' 
                    : 'इमेज डाउनलोड विफल। कृपया पुनः प्रयास करें।');
            } finally {
                downloadBtn.innerHTML = originalText;
                downloadBtn.disabled = false;
            }
        }
        
        // Add event listeners for download buttons
        document.getElementById('downloadBtn').addEventListener('click', function(e) {
            const projectName = document.getElementById('projectName').value;
            const totalManHours = document.getElementById('totalManHours').value;
            
            if (!projectName || !totalManHours) {
                alert(currentLanguage === 'en' 
                    ? 'Please fill in project details and total man-hours before downloading.' 
                    : 'डाउनलोड करने से पहले कृपया प्रोजेक्ट विवरण और कुल मैन-आवर्स भरें।');
                return;
            }
            
            openPopup();
            
            setTimeout(() => {
                downloadPDF.call(this, e);
            }, 1000);
        });
        
        document.getElementById('downloadImageBtn').addEventListener('click', function(e) {
            const projectName = document.getElementById('projectName').value;
            const totalManHours = document.getElementById('totalManHours').value;
            
            if (!projectName || !totalManHours) {
                alert(currentLanguage === 'en' 
                    ? 'Please fill in project details and total man-hours before downloading.' 
                    : 'डाउनलोड करने से पहले कृपया प्रोजेक्ट विवरण और कुल मैन-आवर्स भरें।');
                return;
            }
            
            openPopup();
            
            setTimeout(() => {
                downloadImage.call(this, e);
            }, 1000);
        });
        
        document.getElementById('downloadFromPopup').addEventListener('click', downloadPDF);
        document.getElementById('downloadImageFromPopup').addEventListener('click', downloadImage);
        
        // Reset functionality
        function resetForm() {
            document.querySelectorAll('input, textarea, select').forEach(element => {
                if (element.type !== 'button' && element.type !== 'submit') {
                    element.value = '';
                }
            });
            
            document.getElementById('base-international').checked = true;
            document.getElementById('direct-entry').checked = true;
            calculationHelper.style.display = 'none';
            
            updatePreview();
        }
        
        document.getElementById('resetBtn').addEventListener('click', resetForm);
        
        // Auto-calculate when inputs change
        document.querySelectorAll('#totalManHours, #incidents, input[name="rateBase"]').forEach(element => {
            element.addEventListener('input', updatePreview);
        });
        
        // Initialize
        updatePreview();
    </script>
</body>
</html>
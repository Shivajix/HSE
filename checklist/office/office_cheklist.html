<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Office Safety Report Generator | Comprehensive Workplace Safety Checklist</title>
    <meta name="description" content="Generate comprehensive office safety reports with our easy-to-use checklist. Ensure workplace compliance and employee safety.">
    <meta name="keywords" content="office safety, workplace safety, safety checklist, safety report, OSHA compliance">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --success-color: #27ae60;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --light-color: #ecf0f1;
            --dark-color: #2c3c4e;
            --text-color: #333;
            --bg-color: #fff;
            --card-bg: #f8f9fa;
            --border-color: #ddd;
        }

        .dark-mode {
            --primary-color: #34495e;
            --secondary-color: #2980b9;
            --success-color: #2ecc71;
            --danger-color: #c0392b;
            --warning-color: #e67e22;
            --light-color: #2c3e50;
            --dark-color: #1a252f;
            --text-color: #ecf0f1;
            --bg-color: #1e2a3a;
            --card-bg: #2c3c4e;
            --border-color: #34495e;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: background-color 0.3s, color 0.3s;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 10px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        header {
            background-color: var(--primary-color);
            color: white;
            padding: 15px;
            border-radius: 8px 8px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        h1 {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }

        .header-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        button {
            padding: 8px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .btn-primary {
            background-color: var(--secondary-color);
            color: white;
        }

        .btn-success {
            background-color: var(--success-color);
            color: white;
        }

        .btn-danger {
            background-color: var(--danger-color);
            color: white;
        }

        .btn-warning {
            background-color: var(--warning-color);
            color: white;
        }

        .btn-light {
            background-color: var(--light-color);
            color: var(--text-color);
        }

        .form-section {
            background-color: var(--card-bg);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .form-row {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-group {
            flex: 1;
            min-width: 200px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }

        input, select, textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background-color: var(--bg-color);
            color: var(--text-color);
        }

        textarea {
            min-height: 80px;
            resize: vertical;
        }

        .checklist-section {
            background-color: var(--card-bg);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }

        .section-title {
            font-size: 1.2rem;
            font-weight: 600;
        }

        .section-controls {
            display: flex;
            gap: 10px;
        }

        .checklist-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .item-text {
            flex: 1;
        }

        .item-controls {
            display: flex;
            gap: 15px;
        }

        .radio-group {
            display: flex;
            gap: 10px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .action-items {
            background-color: var(--card-bg);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .action-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            margin-bottom: 10px;
            background-color: var(--bg-color);
            border-radius: 4px;
            border-left: 4px solid var(--warning-color);
        }

        .action-details {
            flex: 1;
        }

        .action-controls {
            display: flex;
            gap: 10px;
        }

        .summary {
            display: flex;
            justify-content: space-around;
            background-color: var(--primary-color);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .summary-item {
            text-align: center;
        }

        .summary-count {
            font-size: 2rem;
            font-weight: bold;
        }

        .hidden {
            display: none;
        }

        .preview-section {
            background-color: var(--card-bg);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .preview-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        .preview-table th, .preview-table td {
            border: 1px solid var(--border-color);
            padding: 8px;
            text-align: left;
        }

        .preview-table th {
            background-color: var(--primary-color);
            color: white;
        }

        .status-pass {
            color: var(--success-color);
            font-weight: bold;
        }

        .status-na {
            color: var(--secondary-color);
            font-weight: bold;
        }

        .status-action {
            color: var(--danger-color);
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
            }
            
            .form-group {
                min-width: 100%;
            }
            
            .checklist-item {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .item-controls {
                margin-top: 10px;
                width: 100%;
                justify-content: space-between;
            }
            
            .header-controls {
                margin-top: 10px;
                width: 100%;
                justify-content: space-between;
            }
            
            .section-controls {
                margin-top: 10px;
                width: 100%;
                justify-content: space-between;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div>
                <h1>Office Safety Report Generator</h1>
                <p>Comprehensive workplace safety inspection for office environments</p>
            </div>
            <div class="header-controls">
                <button id="translateBtn" class="btn-light">
                    <span class="lang-text">हिंदी</span>
                </button>
                <button id="darkModeBtn" class="btn-light">
                    <span class="mode-text">Dark Mode</span>
                </button>
                <button id="previewBtn" class="btn-primary">Preview</button>
                <button id="downloadBtn" class="btn-success">Download PDF</button>
                <button id="resetBtn" class="btn-danger">Reset</button>
            </div>
        </header>

        <main>
            <div id="formView">
                <div class="form-section">
                    <h2>Office Information</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="officeBuilding">Office / Building</label>
                            <input type="text" id="officeBuilding" placeholder="Enter office/building name">
                        </div>
                        <div class="form-group">
                            <label for="floorArea">Floor / Area</label>
                            <input type="text" id="floorArea" placeholder="Enter floor/area">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="dateTime">Date & Time</label>
                            <input type="datetime-local" id="dateTime" value="2025-11-01T16:40">
                        </div>
                        <div class="form-group">
                            <label for="conductedBy">Conducted by</label>
                            <input type="text" id="conductedBy" placeholder="Inspector name">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="department">Department</label>
                            <input type="text" id="department" placeholder="Enter department">
                        </div>
                        <div class="form-group">
                            <label for="occupancy">Occupancy</label>
                            <select id="occupancy">
                                <option value="Low" selected>Low</option>
                                <option value="Medium">Medium</option>
                                <option value="High">High</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="sessionNotes">Session Notes (context, activities, contractors on site, etc.)</label>
                        <textarea id="sessionNotes" placeholder="Enter session notes"></textarea>
                    </div>
                </div>

                <div class="summary">
                    <div class="summary-item">
                        <div class="summary-count" id="passCount">0</div>
                        <div>Pass</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-count" id="naCount">0</div>
                        <div>N/A</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-count" id="actionCount">0</div>
                        <div>Needs Action</div>
                    </div>
                </div>

                <!-- Checklist sections will be dynamically generated here -->
                <div id="checklistSections"></div>

                <div class="action-items">
                    <h2>Action Items (for any "Needs Action" rows)</h2>
                    <div id="actionItemsList">
                        <p>No actions recorded</p>
                    </div>
                    <button id="addActionBtn" class="btn-warning">Add Action</button>
                </div>

                <div class="form-section">
                    <div class="form-group">
                        <label for="finalNotes">Final Notes</label>
                        <textarea id="finalNotes" placeholder="Enter final notes"></textarea>
                    </div>
                </div>
            </div>

            <div id="previewView" class="hidden">
                <div class="preview-section">
                    <h2>Office Safety Report Preview</h2>
                    <div class="header-controls">
                        <button id="backToFormBtn" class="btn-primary">Back to Form</button>
                        <button id="downloadFromPreviewBtn" class="btn-success">Download PDF</button>
                    </div>
                    <div id="previewContent"></div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Checklist data structure for office safety
        const checklistData = [
            {
                title: "Workstation Ergonomics",
                markAll: true,
                items: [
                    "Chair adjusted (lumbar support, height, backrest) and in good condition",
                    "Monitor at eye height; distance ~an arm's length; no glare",
                    "Keyboard/mouse positioned to keep wrists neutral; forearms supported",
                    "Employee takes micro-breaks; stretches; sit-stand desk used correctly"
                ]
            },
            {
                title: "Electrical Safety",
                markAll: true,
                items: [
                    "Power boards not overloaded; no daisy-chaining extension leads",
                    "Cords undamaged; no trip hazards; routed away from walkways",
                    "Portable appliances tested/inspected (PAT) as required",
                    "Server/IT rooms tidy; UPS/ELCB/RCD protection present"
                ]
            },
            {
                title: "Fire Safety",
                markAll: true,
                items: [
                    "Extinguishers & alarms accessible, tagged and in date",
                    "Exit routes and doors unobstructed; illuminated signage working",
                    "Evacuation diagrams posted; assembly point known",
                    "No storage in electrical/risers; fire doors self-close properly"
                ]
            },
            {
                title: "Housekeeping",
                markAll: true,
                items: [
                    "Walkways & aisles clear; cables managed",
                    "Storage shelving stable; heavy items at lower levels",
                    "Waste bins available; recyclables segregated",
                    "Pantry/tea points clean; appliances maintained"
                ]
            },
            {
                title: "Slips, Trips & Falls",
                markAll: true,
                items: [
                    "Floors dry & even; mats secure; spill response available",
                    "Stair treads/handrails intact; edges marked",
                    "No protruding items/boxes obstructing paths",
                    "Cables/chargers kept off the floor or protected"
                ]
            },
            {
                title: "Emergency Preparedness",
                markAll: true,
                items: [
                    "Trained fire wardens & first aiders lists posted/current",
                    "Drill records available; last drill within policy",
                    "Emergency contact numbers displayed",
                    "Business continuity & IT backup procedures known"
                ]
            },
            {
                title: "First Aid & Health",
                markAll: true,
                items: [
                    "First-aid kits stocked & inspected; AED available where required",
                    "Incident/illness reporting process known; posters visible",
                    "Drinking water available; pantry hygiene acceptable",
                    "Indoor plants/pest control maintained"
                ]
            },
            {
                title: "Security & Access",
                markAll: true,
                items: [
                    "Visitor sign-in & badges used; escorts as needed",
                    "Key/card access functioning; tailgating discouraged",
                    "Sensitive areas (server room, records) locked",
                    "CCTV where installed operational; privacy notices displayed"
                ]
            },
            {
                title: "Display Screen Equipment (DSE)",
                markAll: true,
                items: [
                    "Glare controlled (shades/position); lighting comfortable",
                    "Font size/scale adequate; dual-monitor mounts stable",
                    "Laptop users have risers/external keyboard & mouse",
                    "Blue-light / eye-strain controls available if required"
                ]
            },
            {
                title: "Indoor Air Quality & Ventilation",
                markAll: true,
                items: [
                    "HVAC operational; vents unblocked; filters on schedule",
                    "No persistent odors/mold; humidity/temperature acceptable",
                    "Fresh air supply per design; windows operable where intended",
                    "Printers/copiers located/ventilated to reduce emissions"
                ]
            }
        ];

        // Translation data
        const translations = {
            en: {
                title: "Office Safety Report Generator",
                subtitle: "Comprehensive workplace safety inspection for office environments",
                officeBuilding: "Office / Building",
                floorArea: "Floor / Area",
                dateTime: "Date & Time",
                conductedBy: "Conducted by",
                department: "Department",
                occupancy: "Occupancy",
                sessionNotes: "Session Notes (context, activities, contractors on site, etc.)",
                pass: "Pass",
                na: "N/A",
                needsAction: "Needs Action",
                preview: "Preview",
                downloadPDF: "Download PDF",
                reset: "Reset",
                backToForm: "Back to Form",
                markAllPass: "Mark All Pass",
                markAllNA: "Mark All N/A",
                actionItems: "Action Items (for any \"Needs Action\" rows)",
                addAction: "Add Action",
                finalNotes: "Final Notes",
                officeInfo: "Office Information",
                noActions: "No actions recorded",
                remove: "Remove",
                actionRequired: "Action / Control Required",
                owner: "Owner",
                dueDate: "Due Date",
                status: "Status",
                open: "Open"
            },
            hi: {
                title: "कार्यालय सुरक्षा रिपोर्ट जनरेटर",
                subtitle: "कार्यालय वातावरण के लिए व्यापक कार्यस्थल सुरक्षा निरीक्षण",
                officeBuilding: "कार्यालय / भवन",
                floorArea: "मंजिल / क्षेत्र",
                dateTime: "दिनांक और समय",
                conductedBy: "द्वारा आयोजित",
                department: "विभाग",
                occupancy: "अधिभोग",
                sessionNotes: "सत्र नोट्स (संदर्भ, गतिविधियाँ, साइट पर ठेकेदार, आदि)",
                pass: "पास",
                na: "लागू नहीं",
                needsAction: "कार्रवाई आवश्यक",
                preview: "पूर्वावलोकन",
                downloadPDF: "PDF डाउनलोड करें",
                reset: "रीसेट",
                backToForm: "फॉर्म पर वापस जाएं",
                markAllPass: "सभी पास मार्क करें",
                markAllNA: "सभी लागू नहीं मार्क करें",
                actionItems: "कार्रवाई आइटम (किसी भी \"कार्रवाई आवश्यक\" पंक्तियों के लिए)",
                addAction: "कार्रवाई जोड़ें",
                finalNotes: "अंतिम नोट्स",
                officeInfo: "कार्यालय जानकारी",
                noActions: "कोई कार्रवाई दर्ज नहीं की गई",
                remove: "हटाएं",
                actionRequired: "कार्रवाई / नियंत्रण आवश्यक",
                owner: "मालिक",
                dueDate: "नियत तारीख",
                status: "स्थिति",
                open: "खुला"
            }
        };

        // State management
        let state = {
            isHindi: false,
            isDarkMode: false,
            checklistStatus: {},
            actionItems: []
        };

        // Initialize the application
        function init() {
            renderChecklistSections();
            setupEventListeners();
            updateSummary();
            updateActionItemsDisplay();
        }

        // Render checklist sections
        function renderChecklistSections() {
            const container = document.getElementById('checklistSections');
            container.innerHTML = '';

            checklistData.forEach((section, sectionIndex) => {
                const sectionElement = document.createElement('div');
                sectionElement.className = 'checklist-section';
                
                sectionElement.innerHTML = `
                    <div class="section-header">
                        <div class="section-title">${section.title}</div>
                        ${section.markAll ? `
                        <div class="section-controls">
                            <button class="btn-success mark-all-pass" data-section="${sectionIndex}">${state.isHindi ? translations.hi.markAllPass : translations.en.markAllPass}</button>
                            <button class="btn-light mark-all-na" data-section="${sectionIndex}">${state.isHindi ? translations.hi.markAllNA : translations.en.markAllNA}</button>
                        </div>
                        ` : ''}
                    </div>
                `;

                section.items.forEach((item, itemIndex) => {
                    const itemId = `item-${sectionIndex}-${itemIndex}`;
                    // Initialize state for this item
                    if (!state.checklistStatus[itemId]) {
                        state.checklistStatus[itemId] = 'unset';
                    }

                    const itemElement = document.createElement('div');
                    itemElement.className = 'checklist-item';
                    itemElement.innerHTML = `
                        <div class="item-text">${item}</div>
                        <div class="item-controls">
                            <div class="radio-group">
                                <div class="radio-option">
                                    <input type="radio" id="${itemId}-pass" name="${itemId}" value="pass">
                                    <label for="${itemId}-pass">${state.isHindi ? translations.hi.pass : translations.en.pass}</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="${itemId}-na" name="${itemId}" value="na">
                                    <label for="${itemId}-na">${state.isHindi ? translations.hi.na : translations.en.na}</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="${itemId}-action" name="${itemId}" value="action">
                                    <label for="${itemId}-action">${state.isHindi ? translations.hi.needsAction : translations.en.needsAction}</label>
                                </div>
                            </div>
                        </div>
                    `;
                    sectionElement.appendChild(itemElement);
                });

                container.appendChild(sectionElement);
            });

            // Set initial radio button states
            updateRadioButtonsFromState();
        }

        // Update radio buttons based on state
        function updateRadioButtonsFromState() {
            for (const itemId in state.checklistStatus) {
                const status = state.checklistStatus[itemId];
                if (status !== 'unset') {
                    const radio = document.querySelector(`input[name="${itemId}"][value="${status}"]`);
                    if (radio) radio.checked = true;
                }
            }
        }

        // Setup event listeners
        function setupEventListeners() {
            // Mode and language toggles
            document.getElementById('translateBtn').addEventListener('click', toggleLanguage);
            document.getElementById('darkModeBtn').addEventListener('click', toggleDarkMode);
            
            // Main buttons
            document.getElementById('previewBtn').addEventListener('click', showPreview);
            document.getElementById('downloadBtn').addEventListener('click', downloadPDF);
            document.getElementById('resetBtn').addEventListener('click', resetForm);
            
            // Preview buttons
            document.getElementById('backToFormBtn').addEventListener('click', backToForm);
            document.getElementById('downloadFromPreviewBtn').addEventListener('click', downloadPDF);
            
            // Action items
            document.getElementById('addActionBtn').addEventListener('click', addActionItem);
            
            // Mark all buttons
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('mark-all-pass')) {
                    const sectionIndex = e.target.dataset.section;
                    markAllInSection(sectionIndex, 'pass');
                }
                
                if (e.target.classList.contains('mark-all-na')) {
                    const sectionIndex = e.target.dataset.section;
                    markAllInSection(sectionIndex, 'na');
                }
            });
            
            // Radio button changes
            document.addEventListener('change', function(e) {
                if (e.target.type === 'radio') {
                    const itemId = e.target.name;
                    const value = e.target.value;
                    state.checklistStatus[itemId] = value;
                    updateSummary();
                }
            });
        }

        // Mark all items in a section
        function markAllInSection(sectionIndex, status) {
            checklistData[sectionIndex].items.forEach((item, itemIndex) => {
                const itemId = `item-${sectionIndex}-${itemIndex}`;
                state.checklistStatus[itemId] = status;
                
                // Update UI
                const radio = document.querySelector(`input[name="${itemId}"][value="${status}"]`);
                if (radio) radio.checked = true;
            });
            
            updateSummary();
        }

        // Update summary counts
        function updateSummary() {
            let passCount = 0;
            let naCount = 0;
            let actionCount = 0;
            
            for (const itemId in state.checklistStatus) {
                const status = state.checklistStatus[itemId];
                if (status === 'pass') passCount++;
                else if (status === 'na') naCount++;
                else if (status === 'action') actionCount++;
            }
            
            document.getElementById('passCount').textContent = passCount;
            document.getElementById('naCount').textContent = naCount;
            document.getElementById('actionCount').textContent = actionCount;
        }

        // Toggle language
        function toggleLanguage() {
            state.isHindi = !state.isHindi;
            const btn = document.getElementById('translateBtn');
            btn.querySelector('.lang-text').textContent = state.isHindi ? 'English' : 'हिंदी';
            
            // Update all text content
            updateLanguage();
        }

        // Update all text content based on current language
        function updateLanguage() {
            const lang = state.isHindi ? translations.hi : translations.en;
            
            // Update header
            document.querySelector('h1').textContent = lang.title;
            document.querySelector('header p').textContent = lang.subtitle;
            
            // Update form labels
            document.querySelector('label[for="officeBuilding"]').textContent = lang.officeBuilding;
            document.querySelector('label[for="floorArea"]').textContent = lang.floorArea;
            document.querySelector('label[for="dateTime"]').textContent = lang.dateTime;
            document.querySelector('label[for="conductedBy"]').textContent = lang.conductedBy;
            document.querySelector('label[for="department"]').textContent = lang.department;
            document.querySelector('label[for="occupancy"]').textContent = lang.occupancy;
            document.querySelector('label[for="sessionNotes"]').textContent = lang.sessionNotes;
            document.querySelector('label[for="finalNotes"]').textContent = lang.finalNotes;
            
            // Update buttons
            document.getElementById('previewBtn').textContent = lang.preview;
            document.getElementById('downloadBtn').textContent = lang.downloadPDF;
            document.getElementById('resetBtn').textContent = lang.reset;
            document.getElementById('backToFormBtn').textContent = lang.backToForm;
            document.getElementById('downloadFromPreviewBtn').textContent = lang.downloadPDF;
            document.getElementById('addActionBtn').textContent = lang.addAction;
            
            // Update section headers
            document.querySelector('.form-section h2').textContent = lang.officeInfo;
            document.querySelector('.action-items h2').textContent = lang.actionItems;
            
            // Update summary labels
            document.querySelectorAll('.summary-item div:last-child')[0].textContent = lang.pass;
            document.querySelectorAll('.summary-item div:last-child')[1].textContent = lang.na;
            document.querySelectorAll('.summary-item div:last-child')[2].textContent = lang.needsAction;
            
            // Re-render checklist sections to update radio labels
            renderChecklistSections();
            
            // Update action items display
            updateActionItemsDisplay();
        }

        // Toggle dark mode
        function toggleDarkMode() {
            state.isDarkMode = !state.isDarkMode;
            const btn = document.getElementById('darkModeBtn');
            
            if (state.isDarkMode) {
                document.body.classList.add('dark-mode');
                btn.querySelector('.mode-text').textContent = 'Light Mode';
            } else {
                document.body.classList.remove('dark-mode');
                btn.querySelector('.mode-text').textContent = 'Dark Mode';
            }
        }

        // Show preview
        function showPreview() {
            document.getElementById('formView').classList.add('hidden');
            document.getElementById('previewView').classList.remove('hidden');
            
            generatePreviewContent();
        }

        // Back to form
        function backToForm() {
            document.getElementById('formView').classList.remove('hidden');
            document.getElementById('previewView').classList.add('hidden');
        }

        // Generate preview content
        function generatePreviewContent() {
            const previewContent = document.getElementById('previewContent');
            const lang = state.isHindi ? translations.hi : translations.en;
            
            // Get form values
            const officeBuilding = document.getElementById('officeBuilding').value || '—';
            const floorArea = document.getElementById('floorArea').value || '—';
            const dateTime = document.getElementById('dateTime').value || '—';
            const conductedBy = document.getElementById('conductedBy').value || '—';
            const department = document.getElementById('department').value || '—';
            const occupancy = document.getElementById('occupancy').value || '—';
            const sessionNotes = document.getElementById('sessionNotes').value || '—';
            const finalNotes = document.getElementById('finalNotes').value || '—';
            
            // Calculate summary
            let passCount = 0;
            let naCount = 0;
            let actionCount = 0;
            
            for (const itemId in state.checklistStatus) {
                const status = state.checklistStatus[itemId];
                if (status === 'pass') passCount++;
                else if (status === 'na') naCount++;
                else if (status === 'action') actionCount++;
            }
            
            // Build preview HTML
            let html = `
                <div class="form-section">
                    <div class="form-row">
                        <div class="form-group">
                            <label>${lang.officeBuilding}:</label>
                            <p>${officeBuilding}</p>
                        </div>
                        <div class="form-group">
                            <label>${lang.dateTime}:</label>
                            <p>${formatDateTime(dateTime)}</p>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>${lang.floorArea}:</label>
                            <p>${floorArea}</p>
                        </div>
                        <div class="form-group">
                            <label>${lang.department}:</label>
                            <p>${department}</p>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>${lang.conductedBy}:</label>
                            <p>${conductedBy}</p>
                        </div>
                        <div class="form-group">
                            <label>${lang.occupancy}:</label>
                            <p>${occupancy}</p>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>${lang.sessionNotes}:</label>
                        <p>${sessionNotes}</p>
                    </div>
                </div>
                
                <div class="summary">
                    <div class="summary-item">
                        <div class="summary-count">${passCount}</div>
                        <div>${lang.pass}</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-count">${naCount}</div>
                        <div>${lang.na}</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-count">${actionCount}</div>
                        <div>${lang.needsAction}</div>
                    </div>
                </div>
                
                <table class="preview-table">
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>Item</th>
                            <th>Status</th>
                            <th>Notes / Controls</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            // Add checklist items
            checklistData.forEach((section, sectionIndex) => {
                section.items.forEach((item, itemIndex) => {
                    const itemId = `item-${sectionIndex}-${itemIndex}`;
                    const status = state.checklistStatus[itemId] || 'unset';
                    
                    let statusText = '—';
                    let statusClass = '';
                    
                    if (status === 'pass') {
                        statusText = lang.pass;
                        statusClass = 'status-pass';
                    } else if (status === 'na') {
                        statusText = lang.na;
                        statusClass = 'status-na';
                    } else if (status === 'action') {
                        statusText = lang.needsAction;
                        statusClass = 'status-action';
                    }
                    
                    html += `
                        <tr>
                            <td>${section.title}</td>
                            <td>${item}</td>
                            <td class="${statusClass}">${statusText}</td>
                            <td>—</td>
                        </tr>
                    `;
                });
            });
            
            html += `
                    </tbody>
                </table>
                
                <div class="form-section">
                    <div class="form-group">
                        <label>${lang.finalNotes}:</label>
                        <p>${finalNotes}</p>
                    </div>
                </div>
                
                <div class="action-items">
                    <h2>${lang.actionItems}</h2>
                    ${state.actionItems.length > 0 ? 
                        state.actionItems.map(item => `
                            <div class="action-item">
                                <div class="action-details">
                                    <strong>${item.action}</strong><br>
                                    ${lang.owner}: ${item.owner} | ${lang.dueDate}: ${item.dueDate} | ${lang.status}: ${item.status}
                                </div>
                            </div>
                        `).join('') : 
                        `<p>${lang.noActions}</p>`
                    }
                </div>
                
                <div class="form-section">
                    <p><em>Generated on ${new Date().toLocaleString()}</em></p>
                    <p><em>Generated by The HSE Tools - Office Safety Checklist</em></p>
                </div>
            `;
            
            previewContent.innerHTML = html;
        }

        // Format date time for display
        function formatDateTime(dateTimeString) {
            if (!dateTimeString) return '—';
            
            const date = new Date(dateTimeString);
            return date.toLocaleString();
        }

        // Add action item
        function addActionItem() {
            const lang = state.isHindi ? translations.hi : translations.en;
            const action = prompt(`Enter ${lang.actionRequired.toLowerCase()}:`);
            if (!action) return;
            
            const owner = prompt(`Enter ${lang.owner.toLowerCase()}:`);
            const dueDate = prompt(`Enter ${lang.dueDate.toLowerCase()} (YYYY-MM-DD):`);
            const status = lang.open;
            
            state.actionItems.push({
                action,
                owner: owner || "—",
                dueDate: dueDate || "—",
                status
            });
            
            updateActionItemsDisplay();
        }

        // Update action items display
        function updateActionItemsDisplay() {
            const container = document.getElementById('actionItemsList');
            const lang = state.isHindi ? translations.hi : translations.en;
            
            if (state.actionItems.length === 0) {
                container.innerHTML = `<p>${lang.noActions}</p>`;
                return;
            }
            
            let html = '';
            state.actionItems.forEach((item, index) => {
                html += `
                    <div class="action-item">
                        <div class="action-details">
                            <strong>${item.action}</strong><br>
                            ${lang.owner}: ${item.owner} | ${lang.dueDate}: ${item.dueDate} | ${lang.status}: ${item.status}
                        </div>
                        <div class="action-controls">
                            <button class="btn-danger remove-action" data-index="${index}">${lang.remove}</button>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            
            // Add event listeners to remove buttons
            document.querySelectorAll('.remove-action').forEach(button => {
                button.addEventListener('click', function() {
                    const index = parseInt(this.dataset.index);
                    state.actionItems.splice(index, 1);
                    updateActionItemsDisplay();
                });
            });
        }

        // Download PDF
        function downloadPDF() {
            // Show loading indicator
            const originalText = document.querySelector('#downloadBtn').innerHTML;
            document.querySelector('#downloadBtn').innerHTML = 'Generating PDF...';
            document.querySelector('#downloadBtn').disabled = true;
            
            // Use html2canvas and jsPDF to generate PDF
            generatePDF().then(() => {
                // Restore button text
                document.querySelector('#downloadBtn').innerHTML = originalText;
                document.querySelector('#downloadBtn').disabled = false;
            }).catch(error => {
                console.error('Error generating PDF:', error);
                alert('Error generating PDF. Please try again.');
                document.querySelector('#downloadBtn').innerHTML = originalText;
                document.querySelector('#downloadBtn').disabled = false;
            });
        }

        // Generate PDF using html2canvas and jsPDF
        async function generatePDF() {
            const lang = state.isHindi ? translations.hi : translations.en;
            
            // Create a temporary element for PDF generation
            const pdfElement = document.createElement('div');
            pdfElement.style.width = '210mm';
            pdfElement.style.padding = '20px';
            pdfElement.style.backgroundColor = 'white';
            pdfElement.style.color = 'black';
            pdfElement.style.fontFamily = 'Arial, sans-serif';
            
            // Get form values
            const officeBuilding = document.getElementById('officeBuilding').value || '—';
            const floorArea = document.getElementById('floorArea').value || '—';
            const dateTime = document.getElementById('dateTime').value || '—';
            const conductedBy = document.getElementById('conductedBy').value || '—';
            const department = document.getElementById('department').value || '—';
            const occupancy = document.getElementById('occupancy').value || '—';
            const sessionNotes = document.getElementById('sessionNotes').value || '—';
            const finalNotes = document.getElementById('finalNotes').value || '—';
            
            // Calculate summary
            let passCount = 0;
            let naCount = 0;
            let actionCount = 0;
            
            for (const itemId in state.checklistStatus) {
                const status = state.checklistStatus[itemId];
                if (status === 'pass') passCount++;
                else if (status === 'na') naCount++;
                else if (status === 'action') actionCount++;
            }
            
            // Build PDF content
            let html = `
                <h1 style="text-align: center; color: #2c3e50; margin-bottom: 10px;">${lang.title}</h1>
                <p style="text-align: center; margin-bottom: 20px;">${lang.subtitle}</p>
                
                <div style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                    <h2 style="border-bottom: 1px solid #ddd; padding-bottom: 10px; margin-bottom: 15px;">${lang.officeInfo}</h2>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                        <tr>
                            <td style="width: 50%; padding: 5px;"><strong>${lang.officeBuilding}:</strong> ${officeBuilding}</td>
                            <td style="width: 50%; padding: 5px;"><strong>${lang.dateTime}:</strong> ${formatDateTime(dateTime)}</td>
                        </tr>
                        <tr>
                            <td style="width: 50%; padding: 5px;"><strong>${lang.floorArea}:</strong> ${floorArea}</td>
                            <td style="width: 50%; padding: 5px;"><strong>${lang.department}:</strong> ${department}</td>
                        </tr>
                        <tr>
                            <td style="width: 50%; padding: 5px;"><strong>${lang.conductedBy}:</strong> ${conductedBy}</td>
                            <td style="width: 50%; padding: 5px;"><strong>${lang.occupancy}:</strong> ${occupancy}</td>
                        </tr>
                    </table>
                    <div style="margin-bottom: 10px;"><strong>${lang.sessionNotes}:</strong></div>
                    <div style="border: 1px solid #ddd; padding: 10px; min-height: 60px; border-radius: 4px;">${sessionNotes}</div>
                </div>
                
                <div style="display: flex; justify-content: space-around; background-color: #2c3e50; color: white; padding: 15px; border-radius: 5px; margin-bottom: 15px;">
                    <div style="text-align: center;">
                        <div style="font-size: 24px; font-weight: bold;">${passCount}</div>
                        <div>${lang.pass}</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 24px; font-weight: bold;">${naCount}</div>
                        <div>${lang.na}</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 24px; font-weight: bold;">${actionCount}</div>
                        <div>${lang.needsAction}</div>
                    </div>
                </div>
                
                <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                    <thead>
                        <tr style="background-color: #2c3e50; color: white;">
                            <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Category</th>
                            <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Item</th>
                            <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Status</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            // Add checklist items
            checklistData.forEach((section, sectionIndex) => {
                section.items.forEach((item, itemIndex) => {
                    const itemId = `item-${sectionIndex}-${itemIndex}`;
                    const status = state.checklistStatus[itemId] || 'unset';
                    
                    let statusText = '—';
                    let statusColor = 'black';
                    
                    if (status === 'pass') {
                        statusText = lang.pass;
                        statusColor = '#27ae60';
                    } else if (status === 'na') {
                        statusText = lang.na;
                        statusColor = '#3498db';
                    } else if (status === 'action') {
                        statusText = lang.needsAction;
                        statusColor = '#e74c3c';
                    }
                    
                    html += `
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 8px;">${section.title}</td>
                            <td style="border: 1px solid #ddd; padding: 8px;">${item}</td>
                            <td style="border: 1px solid #ddd; padding: 8px; color: ${statusColor}; font-weight: bold;">${statusText}</td>
                        </tr>
                    `;
                });
            });
            
            html += `
                    </tbody>
                </table>
                
                <div style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                    <h2 style="border-bottom: 1px solid #ddd; padding-bottom: 10px; margin-bottom: 15px;">${lang.finalNotes}</h2>
                    <div style="border: 1px solid #ddd; padding: 10px; min-height: 60px; border-radius: 4px;">${finalNotes}</div>
                </div>
                
                <div style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                    <h2 style="border-bottom: 1px solid #ddd; padding-bottom: 10px; margin-bottom: 15px;">${lang.actionItems}</h2>
                    ${state.actionItems.length > 0 ? 
                        state.actionItems.map(item => `
                            <div style="border-left: 4px solid #f39c12; padding: 10px; margin-bottom: 10px; background-color: #f8f9fa;">
                                <strong>${item.action}</strong><br>
                                ${lang.owner}: ${item.owner} | ${lang.dueDate}: ${item.dueDate} | ${lang.status}: ${item.status}
                            </div>
                        `).join('') : 
                        `<p>${lang.noActions}</p>`
                    }
                </div>
                
                <div style="border-top: 1px solid #ddd; padding-top: 15px; margin-top: 20px; font-size: 12px; color: #666;">
                    <p><em>Generated on ${new Date().toLocaleString()}</em></p>
                    <p><em>Generated by The HSE Tools - Office Safety Checklist</em></p>
                </div>
            `;
            
            pdfElement.innerHTML = html;
            document.body.appendChild(pdfElement);
            
            try {
                // Use html2canvas to capture the content
                const canvas = await html2canvas(pdfElement, {
                    scale: 2,
                    useCORS: true,
                    logging: false
                });
                
                // Create PDF
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                
                // Add image to PDF
                const imgData = canvas.toDataURL('image/png');
                const imgWidth = 210; // A4 width in mm
                const pageHeight = 295; // A4 height in mm
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                
                let heightLeft = imgHeight;
                let position = 0;
                
                pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;
                
                // Add new pages if needed
                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }
                
                // Download PDF
                const fileName = `Office_Safety_Report_${officeBuilding.replace(/\s+/g, '_')}_${new Date().toISOString().slice(0, 10)}.pdf`;
                pdf.save(fileName);
                
            } catch (error) {
                console.error('Error generating PDF:', error);
                alert('Error generating PDF. Please try again.');
            } finally {
                // Clean up
                document.body.removeChild(pdfElement);
            }
        }

        // Reset form
        function resetForm() {
            const lang = state.isHindi ? translations.hi : translations.en;
            if (confirm('Are you sure you want to reset the form? All data will be lost.')) {
                // Reset form fields
                document.getElementById('officeBuilding').value = '';
                document.getElementById('floorArea').value = '';
                document.getElementById('dateTime').value = '2025-11-01T16:40';
                document.getElementById('conductedBy').value = '';
                document.getElementById('department').value = '';
                document.getElementById('occupancy').value = 'Low';
                document.getElementById('sessionNotes').value = '';
                document.getElementById('finalNotes').value = '';
                
                // Reset checklist status
                state.checklistStatus = {};
                renderChecklistSections();
                
                // Reset action items
                state.actionItems = [];
                updateActionItemsDisplay();
                
                // Update summary
                updateSummary();
                
                // If in preview, go back to form
                if (!document.getElementById('previewView').classList.contains('hidden')) {
                    backToForm();
                }
            }
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>